#!/bin/bash

# Archy - Local AI Assistant CLI
# Simple wrapper to interact with Archy AI assistant

ARCHY_HOME="${ARCHY_HOME:-$HOME/.archy}"
MCP_SERVER="http://localhost:8000"
GROQ_API_KEY="${GROQ_API_KEY:-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}"

# Color codes
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
NC='\033[0m' # No Color

# Functions
print_info() {
    echo -e "${BLUE}[*]${NC} $1"
}

print_success() {
    echo -e "${GREEN}[+]${NC} $1"
}

print_warning() {
    echo -e "${YELLOW}[!]${NC} $1"
}

print_error() {
    echo -e "${RED}[-]${NC} $1"
}

show_help() {
    cat <<EOF
${GREEN}Archy - Local AI Assistant${NC}

Usage: archy [command] [options]

Commands:
  help              Show this help message
  chat              Enter interactive chat mode
  chat [question]   Ask Archy a single question

Examples:
  archy chat                    # Interactive chat
  archy chat "what tools do I have?"
  archy "what is arch linux?"

For more info: https://github.com/NerfedChou/Archy
EOF
}

# Main logic
if [[ $# -eq 0 ]]; then
    # No arguments: launch interactive chat mode
    print_success "Launching interactive chat..."
    exec python3 "$(dirname "$0")/archy_chat.py"
    exit 0
fi

case "$1" in
    help)
        show_help
        ;;
    chat)
        # Interactive or single-question chat mode
        if [[ $# -eq 1 ]]; then
            # Interactive mode: archy chat
            print_success "Launching interactive chat..."
            exec python3 "$(dirname "$0")/archy_chat.py"
        else
            # Single question mode: archy chat "question"
            shift  # Remove 'chat' from arguments
            exec python3 "$(dirname "$0")/archy_chat.py" "$@"
        fi
        ;;
    *)
        # Default: treat as question for single-query mode
        exec python3 "$(dirname "$0")/archy_chat.py" "$@"
        ;;
esac
